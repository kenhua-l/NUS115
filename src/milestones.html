<!DOCTYPE html>
<html lang="en">
<head>
  <title>NUS115 | Milestones</title>
  @@include('./partials/head.html')
</head>
<body>
  @@include('./partials/header.html')
  <main>
    <div id="clear-animation">
      <div class="animation-container">
        <div class="animation"></div>
      </div>
    </div>
    <div class="wrapper">
      <div class="content-container">
        <div class="animation-container">
          <div class="animation"></div>
        </div>
        <div class="content">
          <span data-page="milestone" class="close-btn">&times;</span>

          <div class="tabs row">
            <p class="selected">TECHNOLOGY</p>
            <ul class="nav nav-tabs" role="tablist"></ul>
          </div>

          <div class="row">
            <div class="col-12 col-lg-7 tab-content"></div>
            <div class="col-12 col-lg-5">
              <div class="milestones-container"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="overlay"></div>
      <!-- @@include('./partials/svg.html') -->
    </div>
  </main>
  @@include('./partials/footer.html')
  @@include('./partials/scripts.html')
  <script>
  $(document).ready(function(){
    var imagePath = baseRef + '/images/milestones/';
    $.ajax({
      type: 'GET',
      url: 'data/milestones.xml',
      dataType: 'xml',
      success: function(data){
        $(data).find('milestone').each(function(){
          var title = $(this).find('title').text();

          // tablist component
          var tablist = '<li class="nav-item" role="tab">' +
          '<a class="nav-link" data-toggle="tab" href="#' + title.toLowerCase() + '">' +
          title.toUpperCase() + '</a></li>';
          $('.nav-tabs').append(tablist);

          // tabpanel component
          var tabpanel = '<div class="tab-pane fade" id="' + title.toLowerCase() + '" role="tabpanel">' +
          '<h2>' + title + '</h2>' +
          '<p>' + $(this).find('description').text() + '</p></div>';
          $('.tab-content').append(tabpanel);

          // slider component
          var milestoneitem = '<div class="milestones-item" data-title="' + title.toLowerCase() + '">' +
          '<img src="' + imagePath + $(this).find('image').text() + '" alt="' + title.toLowerCase() + '">' +
          '<div class="text-overlay"><p class="tag">' + $(this).find('bannertag').text() + '</p>' +
          '<p class="title">' + $(this).find('bannertext').text() + '</p></div></div>';
          $('.milestones-container').append(milestoneitem);

        });

        // Nav tabs
        $('.selected').on('click', function(){
          $('.tabs ul').slideToggle();
        });
        $('.tabs .nav-link').on('click', function(){
          var hash = $(this).attr('href');
          $(location).attr('hash', hash);
          $('.milestones-container').slick('slickGoTo', $('.milestones-item[data-title="' + hash.substr(1) + '"]').data('slick-index'))
        })
        // milestone slick
        $('.milestones-container').slick({
          dots: true,
          adaptiveHeight: false
        })
        $('.milestones-container').on('beforeChange', function(e,s,c,n) {
          var nextSlideTitle = $('.milestones-item[data-slick-index="' + n + '"]').data('title');
          $(location).attr('hash', nextSlideTitle);
          $('.tabs .selected').text(nextSlideTitle.toUpperCase());

          navTabs(false);
        });
        // setup
        navTabs(true);

      },
      error: function(error, text, thrown){
        console.log(text);
      }
    });
  });
  </script>
</body>
</html>
