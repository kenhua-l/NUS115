<!DOCTYPE html>
<html lang="en">

<head>
    <title>NUS115 | Milestones</title>
    <style>
        .content {
            display: flex;
            flex-direction: column;
        }

        .content .tab-content {
            /* flex-grow: 1; */
        }

        .content .tab-content .tab-pane {
            /* height: 100%; */
        }

        .content .tab-content>.active {
            display: flex;
        }
    </style>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="img/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">

    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <link rel="stylesheet" href="./css/all.min.css" />
    <link rel="stylesheet" href="./css/slick.css" />
    <link rel="stylesheet" href="./css/slick-theme.css" />
    <link rel="stylesheet" href="./css/main.css" />
</head>

<body>
    <header class="logo">
        <a href="/"><img src="./images/nus115-logo.png" alt="logo"></a>
    </header>

    <main>
        <div id="clear-animation">
            <div class="animation-container">
                <div class="animation"></div>
            </div>
        </div>
        <div class="wrapper">
            <div class="content-container">
                <div class="animation-container">
                    <div class="animation"></div>
                </div>
                <div class="content">
                    <span data-page="milestone" class="close-btn">&times;</span>

                    <div class="tabs row">
                        <div class="col-12">
                            <p class="selected">TECHNOLOGY</p>
                            <ul class="nav nav-tabs" role="tablist"></ul>
                        </div>
                    </div>

                    <div class="tab-content">
                    </div>
                </div>
            </div>

            <div class="overlay"></div>

        </div>
    </main>
    <footer class="footer-links">
        <div class="d-flex justify-content-center">
            <a href="#" class="social" aria-label="facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social" aria-label="twitter"><i class="fab fa-twitter"></i></a>
            <a href="#" class="social" aria-label="insta"><i class="fab fa-instagram"></i></a>
            <a href="#" class="social" aria-label="linkedin"><i class="fab fa-linkedin-in"></i></a>
            <a href="#" class="social" aria-label="youtube"><i class="fab fa-youtube"></i></a>
            <a href="#" class="social" aria-label="burn"><i class="fas fa-music"></i></a>
        </div>
        <div class="mt-4">
            <small>Â© National University of Singapore. All Right Reserved.</small>
        </div>
    </footer>

    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/slick.min.js" type="text/javascript"></script>
    <script src="js/main.js" type="text/javascript"></script>
    <script>
        $(document).ready(function() {
            var imagePath = baseRef + '/images/milestones/';
            $.ajax({
                type: 'GET',
                url: 'data/milestones.xml',
                dataType: 'xml',
                success: function(data) {
                    $(data).find('milestone').each(function() {
                        var category = $(this).find('category').text();

                        // tablist component
                        var tablist = '<li class="nav-item" role="tab">' +
                            '<a class="nav-link" data-toggle="tab" href="#' + category.toLowerCase() + '">' +
                            category.toUpperCase() + '</a></li>';
                        $('.nav-tabs').append(tablist);

                        // tabpanel component
                        var tabpanel = $('<div class="tab-pane fade row" id="' + category.toLowerCase() + '" role="tabpanel"></div>');

                        var description = $('<div class="col-12 col-lg-7"></div>');
                        description.append('<h2>' + category + '</h2><p>' + $(this).find('description').text() + '</p>');
                        tabpanel.append(description);

                        var slider = $('<div class="milestones-container"></div>');
                        $(this).find('banner').find('banneritem').each(function() {
                            var banneritem = $('<a class="milestones-item" href="' + $(this).find('link').text() + '" target="_blank"></a>');
                            banneritem.append('<img src="' + imagePath + $(this).find('image').text() + '" alt="' + $(this).find('title').text() + '">');
                            banneritem.append('<div class="text-overlay"><p class="tag">' + $(this).find('year').text() + '</p>' +
                                '<p class="title">' + $(this).find('title').text() + '</p></div></div>');
                            slider.append(banneritem);
                        });
                        tabpanel.append($('<div class="col-12 col-lg-5"></div>').append(slider));

                        $('.tab-content').append(tabpanel);


                        // // tabpanel component
                        // var tabpanel = '<div class="tab-pane fade" id="' + category.toLowerCase() + '" role="tabpanel">' +
                        // '<h2>' + category + '</h2>' +
                        // '<p>' + $(this).find('description').text() + '</p></div>';
                        // $('.tab-content').append(tabpanel);
                        //
                        // // slider component
                        // var milestoneitem = '<div class="milestones-item" data-title="' + category.toLowerCase() + '">' +
                        // '<img src="' + imagePath + $(this).find('image').text() + '" alt="' + category.toLowerCase() + '">' +
                        // '<div class="text-overlay"><p class="tag">' + $(this).find('bannertag').text() + '</p>' +
                        // '<p class="title">' + $(this).find('bannertext').text() + '</p></div></div>';
                        // $('.milestones-container').append(milestoneitem);

                    });

                    // Nav tabs
                    $('.selected').on('click', function() {
                        $('.tabs ul').slideToggle();
                    });
                    $('.tabs .nav-link').on('click', function() {
                        console.log('navlink click');
                        var hash = $(this).attr('href');
                        $(location).attr('hash', hash);
                        // $('.milestones-container').resize();
                        // $('.milestones-container').slick('slickGoTo', $('.milestones-item[data-title="' + hash.substr(1) + '"]').data('slick-index'))
                    })
                    $('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
                        console.log('tabpane change');
                        $('.milestones-container').slick('getSlick').refresh();
                        $('.milestones-container').resize();
                    });
                    // milestone slick
                    $('.milestones-container').slick({
                        dots: true,
                        adaptiveHeight: false
                    })
                    // $('.milestones-container').on('beforeChange', function(e,s,c,n) {
                    //   var nextSlideTitle = $('.milestones-item[data-slick-index="' + n + '"]').data('title');
                    //   $(location).attr('hash', nextSlideTitle);
                    //   $('.tabs .selected').text(nextSlideTitle.toUpperCase());
                    //
                    //   navTabs(false);
                    // });
                    // setup
                    navTabs(true);

                },
                error: function(error, text, thrown) {
                    console.log(text);
                }
            });
        });
    </script>
</body>

</html>